# Time-Averaging Surface Output

*Time-Averaging Surface Output in Flow360 allows you to collect statistical data for unsteady simulations, providing time-averaged values of flow field variables on geometry surfaces. This is essential for analyzing periodic or turbulent flows where instantaneous values may fluctuate significantly.*

> **Note**: Time-averaged outputs are only available when using unsteady time stepping methods.

---

### üìã **Available Options**

| **Option** | **Description** | **Unit** |
|------------|-----------------|----------|
| `Name` | Name identifier for the time-averaging output | |
| `Start Step` | Time step at which to begin averaging | time step |
| `Frequency` | How often to save the time-averaged output | time steps |
| `Frequency Offset` | Time step at which to begin saving output | time step |
| `Output Format` | File format for the output files | |
| `Output Fields` | Flow variables to time-average | |
| `Surfaces` | Geometry surfaces to apply time-averaging to | |
| `Write Single File` | Option to write all surfaces to a single file | |

---

### üîç **Detailed Descriptions**

#### `Name`
*An identifier for the time-averaging output configuration.*

- **Default:** `"Time average surface output"`
- **Example:** `"Wing Time-Avg Output"`
- **Notes:** A descriptive name helps identify this specific output in logs and results.

#### `Start Step`
*Specifies the time step at which to begin the time-averaging process.*

- **Default:** `-1` (at end of simulation)
- **Example:** `5000` (start averaging at time step 5000)
- **Notes:** Set this to a time step after initial transients have settled for more meaningful statistics.

#### `Frequency`
*Controls how often the time-averaged output files are generated.*

- **Default:** `-1` (only at end of simulation)
- **Example:** `100` (save time-averaged output every 100 time steps)
- **Notes:** Setting to `-1` will only produce output at the end of the simulation.

#### `Frequency Offset`
*Specifies the time step at which to begin saving the time-averaged output.*

- **Default:** `0` (at beginning of simulation)
- **Example:** `1000` (start saving output at time step 1000)
- **Notes:** This setting works in conjunction with `Frequency` to control the time steps at which output is produced.

#### `Output Format`
*Specifies the file format for the output files.*

- **Default:** `paraview`
- **Options:** `paraview`, `tecplot`, or `both`
- **Notes:** Choose the format that best suits your post-processing workflow.

#### `Output Fields`
*The flow variables that will be time-averaged in the output files.*

- **Example:** `Cp`, `velocity`, `pressure`
- **Notes:** Time-averaging is applied to each selected field independently.

#### `Surfaces`
*The geometry surfaces where time-averaging will be applied.*

- **Example:** `wing`, `fuselage`, `all_walls`
- **Notes:** You can specify individual surfaces or use pattern matching (e.g., `"wall*"`) to select multiple surfaces.

#### `Write Single File`
*Controls whether all surface outputs are written to a single file instead of one file per surface.*

- **Default:** `false`
- **Options:** `true` or `false`
- **Notes:** This option currently only supports Tecplot output format.

---

<details>
<summary><h3 style="display:inline-block"> üí° Tips</h3></summary>

- **Averaging window:** Ensure your simulation runs long enough after the `Start Step` to collect meaningful statistics
- **Transient effects:** Set `Start Step` beyond the initial transient period
- **Periodic flows:** For flows with known periodicity, average over multiple complete cycles
- **Flow stability:** Monitor convergence of time-averaged quantities to ensure statistical stability

#### When visualizing time-averaged surface output, consider:
- Comparing time-averaged and instantaneous fields to identify regions of high unsteadiness
- Using time-averaged fields to calculate stable performance metrics
- Examining the difference between time-averaged and steady-state solutions for similar conditions
- Creating streamlines based on time-averaged velocity fields to reveal mean flow patterns


</details>

---

<details>
<summary><h3 style="display:inline-block"> ‚ùì Frequently Asked Questions</h3></summary>

- **How is time-averaging calculated?**  
  > Time-averaging is calculated using a running average formula:
  > 
  > ```
  > avg_new = avg_old + (new_value - avg_old) / n
  > ```
  > 
  > Where:
  > - `avg_new` is the updated time-average
  > - `avg_old` is the previous time-average
  > - `new_value` is the instantaneous value at the current time step
  > - `n` is the number of samples since the start of averaging

- **What's the difference between time-averaging and animation?**  
  > - **Animation:** Captures instantaneous "snapshots" of the flow at specific time steps (controlled by `Frequency`)
  > - **Time-averaging:** Produces statistical averages over many time steps, reducing noise and revealing mean flow patterns

- **When should I use time-averaging?**  
  > Time-averaging is particularly useful for:
  > 
  > - Turbulent flows where instantaneous values fluctuate significantly
  > - Periodic flows where cycle-to-cycle statistics are of interest
  > - Calculating mean aerodynamic performance metrics in unsteady simulations
  > - Identifying quasi-steady flow features in dynamically changing simulations

</details>

---

<details>
<summary><h3 style="display:inline-block"> üêç Python Example Usage</h3></summary>

```python
# Example of setting up time-averaged surface output in Python
time_avg_output = fl.TimeAverageSurfaceOutput(
    name="Wing and Fuselage Time Avg",  # Descriptive name for this output
    output_format="paraview",
    output_fields=["primitiveVars", "Cp"],
    entities=[
        volume_mesh["wing"],
        volume_mesh["fuselage"],
    ],
    start_step=1000,  # Start averaging after time step 1000
    frequency=100,    # Output every 100 time steps
    frequency_offset=1500,  # Start outputting at time step 1500
)
```

</details> 