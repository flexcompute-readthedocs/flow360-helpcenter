# Time-averaging Slice Output

*Time-averaging Slice Output in Flow360 allows you to calculate and visualize time-averaged flow variables on 2D cutting planes through the computational domain. This provides statistical data essential for analyzing unsteady flows while keeping file sizes much smaller than full volume outputs.*

> **Note**: Time-averaging outputs are only available when using unsteady time stepping methods.

---

## **Available Options**

| *Option* | *Description* | *Applicable* |
|----------|---------------|--------------|
| **Output Fields** | Flow variables to include in the output | always |
| **Output Format** | Format for saving slice data | always |
| **Start Step** | When to begin time-averaging | always |
| **Save interval** | When to save outputs | always |
| **Frequency** | How often to save outputs | when **Save interval** is `Custom` |
| **Frequency Offset** | Time step at which to start the output animation | when **Save interval** is `Custom` |
| **Assigned slices** | Definition of slice planes | always |

---

## **Detailed Descriptions**

### **Output Fields**

*Select the flow variables to include in the slice output.*

- **Default:** None
- **Example:** `Mach, pressure, velocity`
- **Notes:** 
  - See detailed field descriptions in the [Slice Output](05.slice-output.md) page.
  - Only select fields you need to analyze to keep file sizes manageable.

### **Output Format**

*The file format used to save the slice output data.*

- **Default:** `paraview`
- **Options:**
  - `paraview`
  - `tecplot`
  - `both`
- **Notes:** 
  - Choose the format that best suits your post-processing workflow.
  - Select `paraview` for `.vtu` format, `tecplot` for `.plt` format, or `both` to save in both formats.

### **Start Step**

*Specifies the physical time step to start calculating time averaging.*

- **Default:** `-1` (automatic detection)
- **Example:** `50`
- **Notes:** 
  - Set this to begin averaging after initial transients have died out. When set to `-1`, the solver will automatically determine when to start averaging based on flow convergence.

### **Save interval**

*Choose the points in the simulation where the results are saved.*

- **Default:** `Save at end`
- **Options:**
  - `Save at end`
  - `Custom`
- **Notes:** 
  - Choose `Save at end` to save only the final results of the simulation.
  - Choose `Custom` to save the results in given intervals.

### **Frequency**

*How often to save outputs, in number of physical time steps.*

- **Default:** `-1` (only at end of simulation)
- **Example:** `10`
- **Notes:** 
  - Higher frequencies provide better temporal resolution but increase storage requirements.

### **Frequency Offset**

*The time step at which to start the output animation.*

- **Default:** `0` (beginning of simulation)
- **Example:** `100`
- **Notes:** 
  - Useful when you want to skip initial transient flow development.

### **Assigned slices**

*Defines the 2D cutting planes through the computational domain.*

- **Definition parameters:**
  - **Name:** A unique identifier for the slice
  - **Origin:** The 3D coordinates of a point on the slice plane
  - **Normal:** The normal vector to the slice plane (does not need to be normalized)

- **Example:** 
  ```
  Name: "Midspan"
  Origin: (0, 5, 0)
  Normal: (0, 1, 0)
  ```
- **Notes:** 
  - Multiple slices can be defined, each with unique name, origin, and normal.

---

<details>
<summary><h3 style="display:inline-block"> üí° Tips</h3></summary>

Time-averaged slice output is particularly useful in the following scenarios:

1. **Analyzing unsteady flows**: For flows with inherent unsteadiness (like vortex shedding, turbulent wakes, or separated flows), time-averaging on strategic slice planes provides mean flow statistics.

2. **Reducing storage requirements**: Instead of saving many instantaneous snapshots, you can capture the statistical behavior with a single time-averaged result.

3. **Flow stability assessment**: Time-averaged slices help determine if a flow has reached a statistically steady state in key regions, even if instantaneous values are fluctuating.

4. **Strategic slice placement**: Position time-averaged slices at these key locations for maximum insight:
   - **Wake regions** to capture mean wake structures
   - **Boundary layer regions** to observe mean separation behavior
   - **Shear layers** to analyze mean mixing characteristics
   - **Rotor disk planes** for time-averaged BET analysis

#### Visual Analysis Tips

When analyzing time-averaged slice data:

- **Compare with instantaneous slices** at the same location to identify regions of high unsteadiness
- **Look for smoothed features** in the time-averaged data that might be obscured by fluctuations in instantaneous snapshots
- **Create streamlines** on time-averaged slices to visualize mean flow patterns
- **Use multiple slices** at different positions to construct a 3D understanding of the mean flow field

</details>

---

<details>
<summary><h3 style="display:inline-block"> ‚ùì Frequently Asked Questions</h3></summary>

- **When should I use time-averaged slices instead of instantaneous slices?**  
  > Time-averaged slices are ideal when:
  > - You're analyzing statistically steady turbulent flows
  > - You need to filter out transient features or numerical noise
  > - You want to reduce storage requirements while still capturing overall flow behavior
  > - You're interested in mean flow characteristics rather than instantaneous snapshots
  > - You need to identify average positions of features that move over time (e.g., shock waves, separation points)

- **How does the Start Step parameter affect my results?**  
  > The `Start Step` parameter controls when the solver begins accumulating statistics for time-averaging:
  > - Setting it too early may include unwanted transient effects in your averages
  > - Setting it too late may not give enough time for statistical convergence
  > - The automatic setting (`-1`) detects when force coefficients begin to oscillate around a mean value
  > - For better control, monitor your force history and set it manually once transients have subsided

- **Can I get fluctuation intensity or RMS values from time-averaged slices?**  
  > Currently, Flow360 time-averaged outputs include mean values only, not RMS or fluctuation intensities. To obtain these:
  > - Export both instantaneous and time-averaged slice data
  > - Post-process using ParaView/Tecplot to calculate RMS values
  > - For turbulence quantities, consider using the k and omega fields which represent turbulent kinetic energy and specific dissipation rate

- **How many slices can I define for time-averaging?**  
  > There is no hard limit on the number of slices you can define for time-averaging, but consider:
  > - Each slice adds memory overhead during the simulation
  > - Too many slices may impact performance
  > - Start with strategically placed slices and add more if needed

- **Can I use both time-averaged and instantaneous slice outputs in the same simulation?**  
  > Yes, you can define separate outputs for:
  > - Time-averaged slices for statistical analysis
  > - Instantaneous slices for capturing transient phenomena
  > This approach provides comprehensive coverage of both mean flow characteristics and unsteady features.

</details>

---

<details>
<summary><h3 style="display:inline-block"> üêç Python Example Usage</h3></summary>

```python
# Example of configuring time-averaged slice output
from flow360 import u
import flow360 as fl

# Define time-averaged slice output settings
time_avg_slice = fl.TimeAverageSliceOutput(
    name="Time Averaged Wing Sections",
    output_format="paraview",
    slices=[
        fl.Slice(
            name="Root", 
            origin=(0, 0, 0) * u.m, 
            normal=(0, 1, 0)
        ),
        fl.Slice(
            name="Midspan", 
            origin=(0, 0.5, 0) * u.m, 
            normal=(0, 1, 0)
        ),
        fl.Slice(
            name="Tip", 
            origin=(0, 1.0, 0) * u.m, 
            normal=(0, 1, 0)
        )
    ],
    output_fields=["Mach", "pressure", "velocity", "Cp", "Cpt"],
    frequency=10,           # Save results every 10 time steps
    frequency_offset=100,   # Start saving at time step 100
    start_step=50           # Begin averaging at time step 50
)

# Add to simulation parameters
simulation_params = fl.SimulationParams(
    # ... other simulation parameters ...
    outputs=[time_avg_slice]
)
```

</details>
